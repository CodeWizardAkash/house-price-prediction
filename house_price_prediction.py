# -*- coding: utf-8 -*-
"""House price prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1G3LoHZ2KMPJ-mgEbOOxeW77GY22wY-vq
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import sklearn.datasets
from sklearn.model_selection import train_test_split
from xgboost import XGBRegressor
from sklearn import metrics

"""Import the Boston House Price Dataset"""

from google.colab import drive
drive.mount('/content/drive', force_remount=True)

dff = pd.read_csv('/content/drive/My Drive/boston.csv')

dff.head()

dff.shape

#check for missing value
dff.isnull().sum()

# statistical measures of the dataset
dff.describe()

correlation = dff.corr()

correlation

#constructing a heatmap to understand the correlation
plt.figure(figsize=(10,10))
sns.heatmap(correlation, cbar=True, square=True, fmt='.1f', annot=True, annot_kws={'size':8}, cmap='Blues')

"""Splitting the data and Target"""

x = dff.drop(['MEDV'], axis=1)
y = dff['MEDV']

type(x)
type(y)

x.head()

y.head()

"""**Train Test Split**"""

X_train, X_test, Y_train, Y_test = train_test_split(x, y, test_size=0.2, random_state=2)

print(X_train.shape, X_test.shape, Y_train.shape, Y_test.shape)

"""**Model Training**

XGBoost Regressor
"""

# Loading the model
model = XGBRegressor()

#trainging the model
model.fit(X_train, Y_train)

"""**Evaluation The Model**

Prediction on training data
"""

training_data_prediction = model.predict(X_train);

training_data_prediction

# R squared error
score_1 = metrics.r2_score(Y_train, training_data_prediction)
# Mean Absolute Error
score_2 = metrics.mean_absolute_error(Y_train, training_data_prediction)

print("R squared error : ", score_1)
print("Mean Absolute Error : ", score_2)

"""Visualizing the actual Prices and Predicted prices"""

plt.scatter(Y_train, training_data_prediction)
plt.xlabel("Actual Prices")
plt.ylabel("Predicted Prices")
plt.title("Actual Price vs Predicted Price")
plt.show()

"""**Prediction on Test Data**"""

test_data_prediction = model.predict(X_test)

test_data_prediction

# R squared error
score_1 = metrics.r2_score(Y_test, test_data_prediction)
# Mean Absolute Error
score_2 = metrics.mean_absolute_error(Y_test, test_data_prediction)

print("R squared error : ", score_1)
print("Mean Absolute Error : ", score_2)

plt.scatter(Y_test, test_data_prediction)
plt.xlabel("Actual Prices")
plt.ylabel("Predicted Prices")
plt.title("Actual Price vs Predicted Price")
plt.show()

import gradio as gr

def predict_price(features):
    data = np.array(features).reshape(1, -1)
    prediction = model.predict(data)
    return f"Predicted Price: ${prediction[0]*1000:.2f}"

iface = gr.Interface(fn=predict_price,
                     inputs=[gr.Slider(minimum=x[col].min(), maximum=x[col].max(), label=col) for col in x.columns],
                     outputs="text")

iface.launch()

import gradio as gr
import numpy as np

def predict_price(*features):
    data = np.array(features).reshape(1, -1)
    prediction = model.predict(data)
    return f"Predicted Price: ${prediction[0]*1000:.2f}"

iface = gr.Interface(
    fn=predict_price,
    inputs=[gr.Slider(minimum=x[col].min(), maximum=x[col].max(), label=col) for col in x.columns],
    outputs="text"
)

iface.launch()

# 0.00632	18.0	2.31	0	0.538	6.575	65.2	4.0900	1	296.0	15.3	396.90	4.98

